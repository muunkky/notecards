<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design System Demo - Management Change-Proof Theming</title>
    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }
        
        /* Loading state */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            font-size: 1.2rem;
            color: #666;
        }
        
        .loading::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }
        
        @keyframes dots {
            0%, 20% {
                color: rgba(0,0,0,0);
                text-shadow:
                    .25em 0 0 rgba(0,0,0,0),
                    .5em 0 0 rgba(0,0,0,0);
            }
            40% {
                color: #666;
                text-shadow:
                    .25em 0 0 rgba(0,0,0,0),
                    .5em 0 0 rgba(0,0,0,0);
            }
            60% {
                text-shadow:
                    .25em 0 0 #666,
                    .5em 0 0 rgba(0,0,0,0);
            }
            80%, 100% {
                text-shadow:
                    .25em 0 0 #666,
                    .5em 0 0 #666;
            }
        }
        
        /* Hide content initially */
        #app {
            display: none;
        }
        
        /* Error state */
        .error {
            background: #fee;
            color: #c33;
            padding: 1rem;
            margin: 1rem;
            border-radius: 8px;
            border: 1px solid #fcc;
        }
    </style>
</head>
<body>
    <div class="loading" id="loading">
        üé® Loading Design System
    </div>
    
    <div id="error" class="error" style="display: none;">
        <h3>‚ùå Design System Error</h3>
        <p>There was an error loading the design system. Check the console for details.</p>
    </div>
    
    <div id="app">
        <!-- Content will be injected by the design system demo -->
    </div>
    
    <script type="module">
        console.log('üöÄ Design System Demo Starting...');
        
        try {
            // Import and initialize the design system
            import('./src/design-system/index.js')
                .then(designSystem => {
                    console.log('üì¶ Design System Module Loaded');
                    
                    // Design system auto-initializes, but we can also manually init
                    if (designSystem.initializeDesignSystem) {
                        designSystem.initializeDesignSystem();
                    }
                    
                    // Hide loading, show app
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('app').style.display = 'block';
                    
                    console.log('‚úÖ Design System Demo Ready');
                    
                    // Log theme manager for debugging
                    if (designSystem.themeManager) {
                        console.log('üé® Available Themes:', designSystem.themeManager.getAvailableThemes());
                        console.log('üéØ Current Theme:', designSystem.themeManager.getCurrentTheme());
                    }
                })
                .catch(error => {
                    console.error('‚ùå Failed to load design system:', error);
                    
                    // Show error state
                    document.getElementById('loading').style.display = 'none';
                    const errorEl = document.getElementById('error');
                    errorEl.style.display = 'block';
                    errorEl.innerHTML += `<details><summary>Technical Details</summary><pre>${error.stack}</pre></details>`;
                });
        } catch (error) {
            console.error('‚ùå Critical error:', error);
            
            // Show error state
            document.getElementById('loading').style.display = 'none';
            const errorEl = document.getElementById('error');
            errorEl.style.display = 'block';
            errorEl.innerHTML += `<p><strong>Critical Error:</strong> ${error.message}</p>`;
        }
        
        // Performance monitoring
        window.addEventListener('load', () => {
            const perfData = performance.getEntriesByType('navigation')[0];
            console.log(`‚ö° Page Load Performance:
                - DOM Ready: ${perfData.domContentLoadedEventEnd - perfData.domContentLoadedEventStart}ms
                - Full Load: ${perfData.loadEventEnd - perfData.loadEventStart}ms
                - Total Time: ${perfData.loadEventEnd - perfData.navigationStart}ms
            `);
        });
        
        // Theme switching performance monitor
        document.addEventListener('themechange', (event) => {
            console.log(`üé® Theme Switch Performance: ${event.detail.duration}ms`);
            if (event.detail.duration > 100) {
                console.warn('‚ö†Ô∏è Theme switch took longer than 100ms target');
            }
        });
    </script>
    
    <!-- Performance and debugging info -->
    <script>
        // Debug panel (only in development)
        if (window.location.search.includes('debug=true')) {
            const debugPanel = document.createElement('div');
            debugPanel.style.cssText = `
                position: fixed;
                top: 10px;
                right: 10px;
                background: rgba(0,0,0,0.8);
                color: white;
                padding: 10px;
                border-radius: 5px;
                font-family: monospace;
                font-size: 12px;
                z-index: 9999;
                max-width: 300px;
            `;
            debugPanel.innerHTML = `
                <div><strong>üîß Debug Mode</strong></div>
                <div>User Agent: ${navigator.userAgent.split(' ').pop()}</div>
                <div>Viewport: ${window.innerWidth}x${window.innerHeight}</div>
                <div>Theme Support: ${CSS.supports('color', 'var(--test)') ? '‚úÖ' : '‚ùå'}</div>
                <div>Local Storage: ${typeof localStorage !== 'undefined' ? '‚úÖ' : '‚ùå'}</div>
            `;
            document.body.appendChild(debugPanel);
        }
    </script>
</body>
</html>